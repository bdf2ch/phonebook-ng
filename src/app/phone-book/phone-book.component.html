<div id="app-header">

    <!-- Заголовок приложения -->
    <div id="title">
        <div class="logo"><i class="fa fa-phone"></i></div>
        <span class="label">Телефонный справочник</span>
    </div>

    <!-- Панель поиска абонентов -->
    <div id="search">
        <!--<div id="search-left"></div>-->
        <div id="search-center">
            <div class="width-100 padding-left-20 padding-right-20 combined-input">
                <i class="fa fa-search"></i>
                <input type="text" name="" id="" placeholder="Введите имя абонента, телефон или e-mail" [(ngModel)]="phoneBook.searchQuery" (keyup)="searchContacts(phoneBook.searchQuery)">
                <i class="fa fa-times clickable" *ngIf="phoneBook.searchQuery.length > 0" (click)="phoneBook.clearSearch()" title="Очистить поиск"></i>
                <i class="fa fa-gear clickable" *ngIf="phoneBook.contacts.length > 0" (click)="openAtsPanel()" title="Выбрать откуда осуществляется звонок"></i>
            </div>
        </div>
        <div id="search-right">
            <!-- Руководство пользователя -->
            <button type="button" class="btn round small margin-right-10" title="Помощь">
                <i class="fa fa-info"></i>
            </button>

            <!-- Избранные контакты -->
            <button type="button"
                    class="btn small round favorites badged"
                    *ngIf="session.user && phoneBook.favorites.contacts.length > 0"
                    [ngClass]="{'active': phoneBook.isInFavoritesMode === true}"
                    (click)="switchToFavorites()"
                    title="Избранные контакты">
                <span class="badge">{{ phoneBook.favorites.contacts.length }}</span>
                <i class="fa fa-star"></i>
                <span class="corner"></span>
            </button>

            <!-- Авторизация пользователя -->
            <button type="button" class="btn small round" (click)="openAuthModal()" title="Войти" *ngIf="session.user === null" title="Авторизация">
                <i class="fa fa-sign-in"></i>
            </button>

            <!-- Меню пользователя -->
            <div class="user-logged" *ngIf="session.user !== null" (click)="openUserMenuModal()"
                 [ngStyle]="{ 'background': session.user.photo !== null ? 'url(http://10.50.4.7:4444' + session.user.photo + ')' : ''}" title="Меню пользователя">
                <span class="initials" *ngIf="session.user.photo === null">{{ session.user.name[0] + session.user.surname[0] }}</span>
            </div>
        </div>
    </div>


</div>
<div id="app-divisions">
    <!--
    <div id="app-divisions-header">
        <span class="app-title">
            Телефонный справочник
            <button type="button">
        <i class="fa fa-question-circle"></i>
    </button>
        </span>
    </div>
    -->
    <div id="app-divisions-content">
        <division-tree [divisions]="phoneBook.divisions" (onSelect)="selectDivision($event)"></division-tree>
    </div>
</div>



<div id="app-content-wrapper" [ngClass]="{ 'with-ats': isAtsPanelOpened }">

    <!-- Панель выбора АТС -->
    <div id="app-ats" [ngClass]="{ 'opened': isAtsPanelOpened }">
        <div class="ats">
            <span class="title">Вы звоните из</span>
            <select name="ats" id="ats" [(ngModel)]="phoneBook.selectedAts.id" (change)="selectAts()">
                <option value="{{ 17 }}">Аппарат управления</option>
                <option value="{{ 18 }}">Северные электрические сети</option>
                <option value="{{ 19 }}">Центральные электрические сети</option>
            </select>
        </div>
        <div class="close-button" title="Закрыть" (click)="closeAtsPanel()">&times;</div>
    </div>


    <!-- Содержимое активного раздела приложения -->
    <div id="app-content">
        <router-outlet></router-outlet>
    </div>

</div>


<auth [isOpened]="inAuthMode" (onClose)="closeAuthModal()"></auth>
<user-menu [isOpened]="inUserMenuMode" (onClose)="closeUserMenuModal()"></user-menu>
<edit-contact [isOpened]="phoneBook.selectedContact() !== null" (onClose)="closeEditContactModal()" [contact]="phoneBook.selectedContact()"></edit-contact>